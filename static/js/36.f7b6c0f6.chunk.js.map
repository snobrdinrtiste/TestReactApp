{"version":3,"sources":["../node_modules/@arcgis/core/views/2d/layers/features/FeatureStore2D.js","../node_modules/@arcgis/core/views/2d/layers/features/support/FeatureSetReaderPBFIndirect.js","../node_modules/@arcgis/core/views/2d/arcade/callExpressionWithCursor.js","../node_modules/@arcgis/core/views/2d/layers/features/Store2D.js","../node_modules/@arcgis/core/core/CircularArray.js"],"names":["h","t","e","c","I","u","getObjectId","getAttributes","readAttributes","getAttribute","readAttribute","cloneWithGeometry","getGeometry","readHydratedGeometry","getCentroid","readCentroid","l","s","a","r","featureAdapter","events","_featureSetsByInstance","Map","_objectIdToDisplayId","_spatialIndexInvalid","_indexSearchCache","_index","n","minX","_storage","getXMin","minY","getYMin","maxX","getXMax","maxY","getYMax","mode","this","featureCount","vertexCount","has","addOrUpdate","attachStorage","getCursor","next","getDisplayId","setComputedAttributes","scale","set","instance","_insertFeature","emit","_rebuildIndex","id","find","tileId","readers","_searchIndex","bounds","i","getInstanceId","get","push","forEach","d","from","enqueue","getIndex","createDisplayId","setDisplayId","setInstanceId","delete","releaseDisplayId","removeAtIndex","isEmpty","_lookupFeature","_getFeatureSet","setIndex","lookupFeatureByDisplayId","readGeometry","unsetAttributeData","search","setBounds","clear","load","o","createInstance","_currentIndex","_reader","_indices","length","copy","_nextIndex","_getExists","setArcadeSpatialReference","geometryType","hasFeatures","exceededTransferLimit","hasZ","hasM","getStorage","getComputedNumericAtIndex","setComputedNumericAtIndex","getComputedStringAtIndex","setComputedStringAtIndex","transform","joinAttributes","readArcadeFeature","geometry","hasField","setField","keys","castToText","getQuantizationTransform","getAttributeHash","getGroupId","setGroupId","getXHydrate","getYHydrate","getX","getY","readLegacyFeature","readOptimizedFeature","readLegacyPointGeometry","readLegacyGeometry","readLegacyCentroid","readGeometryArea","readUnquantizedGeometry","Error","referencesGeometry","evaluate","$feature","getLogger","warn","_canCacheExpressionValue","_sourceInfo","_bitsets","computed","getBitset","createBitset","_schema","console","debug","targets","name","attributes","type","_createArcadeComputedField","_createLabelArcadeComputedField","Promise","all","_computedFields","some","expression","referencesScale","_statisticFields","_evaluateField","resultType","fieldIndex","spatialReference","fieldsIndex","valueExpression","createLabelFunction","label","builder","$view","Number","POSITIVE_INFINITY","size","_start","maxSize","_buffer","isFinite","Array","dequeue"],"mappings":"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","file":"static/js/36.f7b6c0f6.chunk.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport t from\"../../../../core/CircularArray.js\";import e from\"../../../../core/Evented.js\";import\"../../../../core/has.js\";import{isNone as s,isSome as a,unwrap as r}from\"../../../../core/maybe.js\";import{r as n}from\"../../../../chunks/rbush.js\";import{fromRect as i}from\"../../../../geometry/support/aaBoundingBox.js\";import{Store2D as o}from\"./Store2D.js\";import{FeatureSetReaderIndirect as d}from\"./support/FeatureSetReaderPBFIndirect.js\";function h(t,e){return t<<16|e}function c(t){return(4294901760&t)>>>16}function I(t){return 65535&t}const u={getObjectId:t=>t.getObjectId(),getAttributes:t=>t.readAttributes(),getAttribute:(t,e)=>t.readAttribute(e),cloneWithGeometry:(t,e)=>t,getGeometry:t=>t.readHydratedGeometry(),getCentroid:(t,e)=>t.readCentroid()};class l extends o{constructor(s,a,r){super(s,a),this.featureAdapter=u,this.events=new e,this._featureSetsByInstance=new Map,this._objectIdToDisplayId=new Map,this._spatialIndexInvalid=!0,this._indexSearchCache=new t(50),this._index=n(9,(t=>({minX:this._storage.getXMin(t),minY:this._storage.getYMin(t),maxX:this._storage.getXMax(t),maxY:this._storage.getYMax(t)}))),this._storage=a,this.mode=r}get storage(){return this._storage}get storeStatistics(){return{featureCount:0,vertexCount:0}}hasInstance(t){return this._featureSetsByInstance.has(t)}onTileData(t,e){if(s(e.addOrUpdate))return e;if(e.addOrUpdate.attachStorage(this._storage),\"snapshot\"===this.mode){const s=e.addOrUpdate.getCursor();for(;s.next();){const e=s.getDisplayId();this.setComputedAttributes(this._storage,s,e,t.scale)}return e}this._featureSetsByInstance.set(e.addOrUpdate.instance,e.addOrUpdate);const a=e.addOrUpdate.getCursor();for(;a.next();)this._insertFeature(a,t.scale);return this._spatialIndexInvalid=!0,this.events.emit(\"changed\"),e}search(t){this._rebuildIndex();const e=t.id,s=this._indexSearchCache.find((t=>t.tileId===e));if(a(s))return s.readers;const r=new Map,n=this._searchIndex(t.bounds),i=[];for(const a of n){const t=this._storage.getInstanceId(a),e=c(t),s=I(t);r.has(e)||r.set(e,[]);r.get(e).push(s)}return r.forEach(((t,e)=>{const s=this._featureSetsByInstance.get(e);i.push(d.from(s,t))})),this._indexSearchCache.enqueue({tileId:e,readers:i}),i}insert(t){const e=t.getCursor(),s=this._storage;for(;e.next();){var a;const t=h(e.instance,e.getIndex()),r=e.getObjectId(),n=null!=(a=this._objectIdToDisplayId.get(r))?a:this._storage.createDisplayId();e.setDisplayId(n),s.setInstanceId(n,t),this._objectIdToDisplayId.set(r,n)}this._featureSetsByInstance.set(t.instance,t),this._spatialIndexInvalid=!0}remove(t){const e=this._objectIdToDisplayId.get(t);if(!e)return;const s=this._storage.getInstanceId(e),a=I(s),r=c(s),n=this._featureSetsByInstance.get(r);this._objectIdToDisplayId.delete(t),this._storage.releaseDisplayId(e),n.removeAtIndex(a),n.isEmpty&&this._featureSetsByInstance.delete(r),this._spatialIndexInvalid=!0}forEach(t){this._objectIdToDisplayId.forEach((e=>{const s=this._storage.getInstanceId(e),a=this._lookupFeature(s);t(a)}))}forEachUnsafe(t){this._objectIdToDisplayId.forEach((e=>{const s=this._storage.getInstanceId(e),a=c(s),r=I(s),n=this._getFeatureSet(a);n.setIndex(r),t(n)}))}forEachInBounds(t,e){const s=this._searchIndex(t);for(const a of s){const t=this.lookupFeatureByDisplayId(a,this._storage);e(r(t))}}forEachBounds(t,e,s){this._rebuildIndex();const a=[0,0,0,0];for(const r of t){if(!r.readGeometry())continue;const t=r.getDisplayId();a[0]=this._storage.getXMin(t),a[1]=this._storage.getYMin(t),a[2]=this._storage.getXMax(t),a[3]=this._storage.getYMax(t),e(i(s,a))}}sweepFeatures(t,e,s){this._spatialIndexInvalid=!0,this._objectIdToDisplayId.forEach(((a,r)=>{t.has(a)||(e.releaseDisplayId(a),s&&s.unsetAttributeData(a),this._objectIdToDisplayId.delete(r))})),this.events.emit(\"changed\")}sweepFeatureSets(t){this._spatialIndexInvalid=!0,this._featureSetsByInstance.forEach(((e,s)=>{t.has(s)||this._featureSetsByInstance.delete(s)}))}lookupObjectId(t,e){const a=this.lookupFeatureByDisplayId(t,e);return s(a)?null:a.getObjectId()}lookupDisplayId(t){return this._objectIdToDisplayId.get(t)}lookupFeatureByDisplayId(t,e){const s=e.getInstanceId(t);return this._lookupFeature(s)}lookupByDisplayIdUnsafe(t){const e=this._storage.getInstanceId(t),s=c(e),a=I(e),r=this._getFeatureSet(s);return r?(r.setIndex(a),r):null}_insertFeature(t,e){const s=this._storage,a=t.getObjectId(),r=h(t.instance,t.getIndex());s.getInstanceId(t.getDisplayId());let n=this._objectIdToDisplayId.get(a);n||(n=s.createDisplayId(),this._objectIdToDisplayId.set(a,n),this._spatialIndexInvalid=!0),t.setDisplayId(n),s.setInstanceId(n,r),this.setComputedAttributes(s,t,n,e)}_searchIndex(t){this._rebuildIndex();const e={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]};return this._index.search(e)}_rebuildIndex(){if(!this._spatialIndexInvalid)return;const t=[];\"snapshot\"===this.mode?this._featureSetsByInstance.forEach((e=>{const s=e.getCursor();for(;s.next();){const e=s.getDisplayId();this._storage.setBounds(e,s)&&t.push(e)}})):this._objectIdToDisplayId.forEach((e=>{const s=this._storage.getInstanceId(e);this._storage.setBounds(e,this._lookupFeature(s))&&t.push(e)})),this._index.clear(),this._index.load(t),this._indexSearchCache.clear(),this._spatialIndexInvalid=!1}_lookupFeature(t){const e=c(t),s=I(t),a=this._getFeatureSet(e);if(!a)return null;const r=a.getCursor();return r.setIndex(s),r}_getFeatureSet(t){return this._featureSetsByInstance.get(t)}}export{l as FeatureStore2D,u as featureAdapter};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{FeatureSetReader as e}from\"./FeatureSetReader.js\";class r extends e{constructor(r,t){super(e.createInstance()),this._currentIndex=-1,this._reader=r,this._indices=t}static from(e,t){return new r(e.copy(),t)}get hasNext(){return this._currentIndex+1<this._indices.length}getSize(){return this._indices.length}getCursor(){return this.copy()}copy(){const e=new r(this._reader.copy(),this._indices);return e._currentIndex=this._currentIndex,e}next(){for(;this._nextIndex()&&!this._reader._getExists(););return this._currentIndex<this._indices.length}_nextIndex(){return++this._currentIndex<this._indices.length&&(this._reader.setIndex(this._indices[this._currentIndex]),!0)}setArcadeSpatialReference(e){this._reader.setArcadeSpatialReference(e)}attachStorage(e){this._reader.attachStorage(e)}get geometryType(){return this._reader.geometryType}get hasFeatures(){return this._reader.hasFeatures}get exceededTransferLimit(){return this._reader.exceededTransferLimit}get hasZ(){return this._reader.hasZ}get hasM(){return this._reader.hasM}getStorage(){return this._reader.getStorage()}getComputedNumeric(e){return this._reader.getComputedNumericAtIndex(0)}setComputedNumeric(e,r){return this._reader.setComputedNumericAtIndex(r,0)}getComputedString(e){return this._reader.getComputedStringAtIndex(0)}setComputedString(e,r){return this._reader.setComputedStringAtIndex(0,r)}getComputedNumericAtIndex(e){return this._reader.getComputedNumericAtIndex(e)}setComputedNumericAtIndex(e,r){this._reader.setComputedNumericAtIndex(e,r)}getComputedStringAtIndex(e){return this._reader.getComputedStringAtIndex(e)}setComputedStringAtIndex(e,r){return this._reader.setComputedStringAtIndex(e,r)}transform(e,r,t,d){const a=this.copy();return a._reader=this._reader.transform(e,r,t,d),a}readAttribute(e,r=!1){return this._reader.readAttribute(e,r)}readAttributes(){return this._reader.readAttributes()}joinAttributes(e){return this._reader.joinAttributes(e)}readArcadeFeature(){return this._reader.readArcadeFeature()}geometry(){return this._reader.geometry()}field(e){return this.readAttribute(e,!0)}hasField(e){return this._reader.hasField(e)}setField(e,r){return this._reader.setField(e,r)}keys(){return this._reader.keys()}castToText(){return this._reader.castToText()}getQuantizationTransform(){return this._reader.getQuantizationTransform()}getAttributeHash(){return this._reader.getAttributeHash()}getObjectId(){return this._reader.getObjectId()}getDisplayId(){return this._reader.getDisplayId()}setDisplayId(e){return this._reader.setDisplayId(e)}getGroupId(){return this._reader.getGroupId()}setGroupId(e){return this._reader.setGroupId(e)}getXHydrate(){return this._reader.getXHydrate()}getYHydrate(){return this._reader.getYHydrate()}getX(){return this._reader.getX()}getY(){return this._reader.getY()}setIndex(e){return this._reader.setIndex(e)}getIndex(){return this._reader.getIndex()}readLegacyFeature(){return this._reader.readLegacyFeature()}readOptimizedFeature(){return this._reader.readOptimizedFeature()}readLegacyPointGeometry(){return this._reader.readLegacyPointGeometry()}readLegacyGeometry(){return this._reader.readLegacyGeometry()}readLegacyCentroid(){return this._reader.readLegacyCentroid()}readGeometryArea(){return this._reader.readGeometryArea()}readUnquantizedGeometry(){return this._reader.readUnquantizedGeometry()}readHydratedGeometry(){return this._reader.readHydratedGeometry()}readGeometry(){return this._reader.readGeometry()}readCentroid(){return this._reader.readCentroid()}_readAttribute(e,r){throw new Error(\"Error: Should not be called. Underlying _reader should be used instead\")}_readAttributes(){throw new Error(\"Error: Should not be called. Underlying _reader should be used instead\")}}export{r as FeatureSetReaderIndirect};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport e from\"../../../core/Logger.js\";function r(r,a,t){r.referencesGeometry();const n=a.readArcadeFeature();try{return r.evaluate({...t,$feature:n})}catch(o){return e.getLogger(\"esri.views.2d.support.arcadeOnDemand\").warn(\"Feature arcade evaluation failed:\",o),null}}export default r;\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport e from\"../../../../core/has.js\";import{isNone as s}from\"../../../../core/maybe.js\";import{diff as t,hasDiff as i}from\"../../../../core/accessorSupport/diffUtils.js\";import{createRendererExpression as a}from\"../../../../support/arcadeOnDemand.js\";import r from\"../../arcade/callExpressionWithCursor.js\";const c=import(\"../../../../layers/support/labelFormatUtils.js\");class o{constructor(e,s){this._canCacheExpressionValue=!1,this._sourceInfo=e,this._bitsets={computed:s.getBitset(s.createBitset())}}invalidate(){this._bitsets.computed.clear()}async updateSchema(a,r){const c=t(this._schema,r);if(this._schema=r,!r||s(c)||!i(c,\"attributes\"))return;e(\"esri-2d-update-debug\")&&console.debug(\"Applying Update - Store:\",c),this._bitsets.computed.clear(),a.targets[r.name]=!0;const o=r.attributes,n=[],d=[];for(const e in o){const s=o[e];switch(s.type){case\"field\":break;case\"expression\":n.push(this._createArcadeComputedField(s));break;case\"label-expression\":n.push(this._createLabelArcadeComputedField(s));break;case\"statistic\":d.push(s)}}this._computedFields=await Promise.all(n),this._canCacheExpressionValue=!this._computedFields.some((e=>\"expression\"===e.type&&e.expression.referencesScale())),this._statisticFields=d}setComputedAttributes(e,s,t,i){const a=this._bitsets.computed;if(!this._canCacheExpressionValue||!a.has(t)){a.set(t);for(const a of this._computedFields){const r=this._evaluateField(s,a,i);switch(a.resultType){case\"numeric\":e.setComputedNumericAtIndex(t,a.fieldIndex,r);break;case\"string\":e.setComputedStringAtIndex(t,a.fieldIndex,r)}}}}async _createArcadeComputedField(e){const s=this._sourceInfo.spatialReference,t=this._sourceInfo.fieldsIndex;return{...e,expression:await a(e.valueExpression,s,t)}}async _createLabelArcadeComputedField(e){const s=this._sourceInfo.spatialReference,t=this._sourceInfo.fieldsIndex,{createLabelFunction:i}=await c,a=await i(e.label,t,s);return{...e,builder:a}}_evaluateField(e,s,t){switch(s.type){case\"label-expression\":{const t=e.readArcadeFeature();return s.builder.evaluate(t)||\"\"}case\"expression\":{const{expression:i}=s;return r(i,e,{$view:{scale:t}})}}}}export{o as Store2D};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{isSome as t}from\"./maybe.js\";class s{constructor(t=Number.POSITIVE_INFINITY){this.size=0,this._start=0,this.maxSize=t,this._buffer=isFinite(t)?new Array(t):[]}get entries(){return this._buffer}enqueue(t){if(this.size===this.maxSize){const s=this._buffer[this._start];return this._buffer[this._start]=t,this._start=(this._start+1)%this.maxSize,s}return isFinite(this.maxSize)?this._buffer[(this._start+this.size++)%this.maxSize]=t:this._buffer[this._start+this.size++]=t,null}dequeue(){if(0===this.size)return null;const t=this._buffer[this._start];return this._buffer[this._start]=null,this.size--,this._start=(this._start+1)%this.maxSize,t}peek(){return 0===this.size?null:this._buffer[this._start]}find(s){if(0===this.size)return null;for(const i of this._buffer)if(t(i)&&s(i))return i;return null}clear(s){let i=this.dequeue();for(;t(i);)s&&s(i),i=this.dequeue()}}export default s;\n"],"sourceRoot":""}